import{a as U}from"./chunk-NXZJFQIH.js";import{D as q,G as V,H as G,J as k,K as z}from"./chunk-P7ZXRJB5.js";import{d as I,g as S}from"./chunk-AICMW4LS.js";import"./chunk-ER4RSQOA.js";import{b as P,c as F,d as W,e as j,f as T,g as R,i as A,j as B,k as D,l as L,o as b}from"./chunk-XHTFFY4H.js";import{j as x,k as E,r as h}from"./chunk-SIBEU5US.js";import{Ca as f,Ha as v,Ia as C,K as y,Ma as _,Ua as l,Va as t,Wa as i,Xa as O,db as w,ib as d,jb as N,mb as p,nb as u,ob as c,ta as m}from"./chunk-2JCYUYSE.js";import"./chunk-KAT7YFEL.js";function K(o,a){if(o&1&&(t(0,"option",22),d(1),i()),o&2){let r=a.$implicit;l("value",r),m(),N(r)}}function Q(o,a){o&1&&(t(0,"span"),d(1,"Save & Continue"),i())}function X(o,a){o&1&&(t(0,"span"),d(1,"Processing..."),i())}var g=class o{constructor(a,r,e,s){this.cs=a;this.auth=r;this.fs=e;this.router=s}companyCode="";businessName="";industry="";address="";gst="";loading=!1;industries=["Restaurant","Retail","Medical","Electrical"];async ngOnInit(){let a=this.auth.getCurrentUid();if(!a){this.router.navigate(["/auth/login"]);return}let r=await G(V(this.fs,`users/${a}`));if(!r.exists()){this.router.navigate(["/auth/login"]);return}let e=r.data();if(this.companyCode=e.companyId??e.companyCode??"",this.companyCode){let s=await this.cs.getCompany(this.companyCode);if(s&&(this.businessName=s.businessName??"",this.industry=s.industry??"",this.address=s.address??"",this.gst=s.gst??"",this.industry)){this.auth.industrySubject?.next(this.industry),this.router.navigate(["/dashboard"]);return}}}async submit(){if(!this.companyCode){alert("Company code is missing. Choose a unique code.");return}this.loading=!0;try{await this.cs.updateCompany(this.companyCode,{companyCode:this.companyCode,businessName:this.businessName,industry:this.industry,address:this.address,gst:this.gst}),await this.auth.setIndustryForCompany(this.companyCode,this.industry),this.router.navigate(["/dashboard"])}catch(a){alert(a.message||"Failed to save company")}finally{this.loading=!1}}static \u0275fac=function(r){return new(r||o)(f(z),f(k),f(q),f(I))};static \u0275cmp=v({type:o,selectors:[["app-onboarding"]],decls:39,vars:9,consts:[[1,"onboarding-container","container","py-5"],[1,"row","justify-content-center"],[1,"col-md-8","col-lg-6"],[1,"card","shadow-sm","border-0"],[1,"text-center","p-4"],["src","assets/images/chanmura.jpg","alt","Chanmura Logo",1,"company-logo"],[1,"mt-3","text-primary","fw-bold"],[1,"text-muted","small"],[1,"card-body","px-4","pb-4"],[3,"ngSubmit"],[1,"mb-3"],[1,"form-label","fw-semibold"],["type","text","name","companyCode","required","",1,"form-control",3,"ngModelChange","ngModel"],["type","text","name","businessName","required","",1,"form-control",3,"ngModelChange","ngModel"],["name","industry","required","",1,"form-select",3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["rows","3","name","address",1,"form-control",3,"ngModelChange","ngModel"],["type","text","name","gst",1,"form-control",3,"ngModelChange","ngModel"],[1,"d-grid"],["type","submit",1,"btn","btn-primary","btn-lg",3,"disabled"],[4,"ngIf"],[3,"value"]],template:function(r,e){r&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),O(5,"img",5),t(6,"h3",6),d(7,"Complete Business Details"),i(),t(8,"p",7),d(9,"Please fill in your business information to proceed"),i()(),t(10,"div",8)(11,"form",9),w("ngSubmit",function(){return e.submit()}),t(12,"div",10)(13,"label",11),d(14,"Company Code"),i(),t(15,"input",12),c("ngModelChange",function(n){return u(e.companyCode,n)||(e.companyCode=n),n}),i()(),t(16,"div",10)(17,"label",11),d(18,"Business Name"),i(),t(19,"input",13),c("ngModelChange",function(n){return u(e.businessName,n)||(e.businessName=n),n}),i()(),t(20,"div",10)(21,"label",11),d(22,"Industry"),i(),t(23,"select",14),c("ngModelChange",function(n){return u(e.industry,n)||(e.industry=n),n}),t(24,"option",15),d(25,"Select industry"),i(),_(26,K,2,2,"option",16),i()(),t(27,"div",10)(28,"label",11),d(29,"Address"),i(),t(30,"textarea",17),c("ngModelChange",function(n){return u(e.address,n)||(e.address=n),n}),i()(),t(31,"div",10)(32,"label",11),d(33,"GST"),i(),t(34,"input",18),c("ngModelChange",function(n){return u(e.gst,n)||(e.gst=n),n}),i()(),t(35,"div",19)(36,"button",20),_(37,Q,2,0,"span",21)(38,X,2,0,"span",21),i()()()()()()()()),r&2&&(m(15),p("ngModel",e.companyCode),m(4),p("ngModel",e.businessName),m(4),p("ngModel",e.industry),m(3),l("ngForOf",e.industries),m(4),p("ngModel",e.address),m(4),p("ngModel",e.gst),m(2),l("disabled",e.loading),m(),l("ngIf",!e.loading),m(),l("ngIf",e.loading))},dependencies:[h,x,E,b,R,B,D,P,A,F,W,L,T,j],styles:[".onboarding-container[_ngcontent-%COMP%]{max-width:100%}.company-logo[_ngcontent-%COMP%]{max-height:90px;width:auto}.card[_ngcontent-%COMP%]{border-radius:14px}.form-label[_ngcontent-%COMP%]{font-size:.9rem}.form-control[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%]{padding:10px 14px;border-radius:8px}.btn-primary[_ngcontent-%COMP%]{background-color:#004f9f;border-color:#004f9f;border-radius:8px;font-weight:600}.btn-primary[_ngcontent-%COMP%]:hover{background-color:#003c7a;border-color:#003c7a}textarea[_ngcontent-%COMP%]{resize:none}"]})};var Y=[{path:"",component:g,canActivate:[U]}],M=class o{static \u0275fac=function(r){return new(r||o)};static \u0275mod=C({type:o});static \u0275inj=y({imports:[S.forChild(Y),S]})};var J=class o{static \u0275fac=function(r){return new(r||o)};static \u0275mod=C({type:o});static \u0275inj=y({imports:[h,b,M,g]})};export{J as OnboardingModule};
