import{a as Q}from"./chunk-DKTPNKVH.js";import{a as q}from"./chunk-Z7P27EYM.js";import"./chunk-AEGG3O7Y.js";import"./chunk-P7ZXRJB5.js";import"./chunk-ER4RSQOA.js";import{b as z,c as j,f as L,o as W}from"./chunk-XHTFFY4H.js";import{i as N,j as A,k as R,o as k,p as $,r as V}from"./chunk-SIBEU5US.js";import{$a as w,Ca as u,Cb as H,Ha as I,Ma as g,T as E,U as D,Ua as m,Va as t,Wa as e,_a as M,ab as P,db as v,eb as b,ib as n,jb as c,kb as d,m as O,mb as B,nb as T,ob as F,rb as p,sb as h,ta as a,tb as _}from"./chunk-2JCYUYSE.js";import{a as S,b as C}from"./chunk-KAT7YFEL.js";var U=["class","component"];function G(o,l){o&1&&(t(0,"h1"),n(1,"Still no orders Today"),e())}function J(o,l){if(o&1&&(t(0,"tr")(1,"td"),n(2),e(),t(3,"td"),n(4),e(),t(5,"td"),n(6),e(),t(7,"td"),n(8),e()()),o&2){let i=l.$implicit;a(2),c(i.name),a(2),c(i.quantity),a(2),d("\u20B9",i.price),a(2),d("\u20B9",i.totalPrice)}}function K(o,l){if(o&1&&(t(0,"tr",20)(1,"td",21)(2,"h5"),n(3,"\u{1F6D2} Items"),e(),t(4,"div",14)(5,"table",22)(6,"thead")(7,"tr")(8,"th"),n(9,"Item Name"),e(),t(10,"th"),n(11,"Qty"),e(),t(12,"th"),n(13,"Price"),e(),t(14,"th"),n(15,"Total"),e()()(),t(16,"tbody"),g(17,J,9,4,"tr",17),e()()()()()),o&2){let i=b().$implicit;a(17),m("ngForOf",i.items)}}function X(o,l){if(o&1){let i=P();M(0),t(1,"tr")(2,"td"),n(3),e(),t(4,"td"),n(5),e(),t(6,"td"),n(7),e(),t(8,"td")(9,"strong"),n(10),e()(),t(11,"td"),n(12),p(13,"date"),e(),t(14,"td")(15,"button",18),v("click",function(){let s=E(i).$implicit;return D(s.showItems=!s.showItems)}),n(16),e()()(),g(17,K,18,1,"tr",19),w()}if(o&2){let i=l.$implicit;a(3),c(i.orderId),a(2),c(i.customerName),a(2),c(i.mobileNumber),a(3),d("\u20B9",i.totalAmount),a(2),c(_(13,7,i.createdAt,"shortTime")),a(4),d(" ",i.showItems?"Hide":"View"," Items "),a(),m("ngIf",i.showItems)}}function Y(o,l){if(o&1&&(t(0,"div",14)(1,"table",15)(2,"thead",16)(3,"tr")(4,"th"),n(5,"Order ID"),e(),t(6,"th"),n(7,"Name"),e(),t(8,"th"),n(9,"Mobile"),e(),t(10,"th"),n(11,"Total Amount"),e(),t(12,"th"),n(13,"Time"),e(),t(14,"th"),n(15,"Items"),e()()(),t(16,"tbody"),g(17,X,18,10,"ng-container",17),p(18,"async"),e()()()),o&2){let i=b();a(17),m("ngForOf",h(18,1,i.filteredOrders$))}}var x=class o{constructor(l,i,r){this.firebaseService=l;this.expensesService=i;this.cdr=r;this.loadOrdersByDate(),this.loadTodayFinance()}selectedDate="";today=new Date;filteredOrders$;revenue=0;expense=0;profit=0;loss=0;async loadTodayFinance(){console.log("Loading today's finance data...",this.selectedDate),this.firebaseService.getOrderbyDate(this.selectedDate).subscribe(l=>{this.revenue=l.reduce((i,r)=>i+(r.totalAmount||0),0)}),this.expensesService.getExpensesByDate(this.selectedDate).subscribe(l=>{this.expense=l.reduce((i,r)=>i+(r.amount||0),0),this.revenue>this.expense?(this.profit=this.revenue-this.expense,this.loss=0):(this.loss=this.expense-this.revenue,this.profit=0),this.cdr.detectChanges()})}loadOrdersByDate(){let l=this.firebaseService.getOrderbyDate(this.selectedDate).pipe(O(i=>i.map(r=>C(S({},r),{createdAt:r.createdAt?.toDate?r.createdAt.toDate():new Date(r.createdAt),showItems:!1})).sort((r,s)=>Number(r.orderId)-Number(s.orderId))));this.filteredOrders$=l,this.loadTodayFinance()}static \u0275fac=function(i){return new(i||o)(u(q),u(Q),u(H))};static \u0275cmp=I({type:o,selectors:[["app-orders-home",8,"component"]],attrs:U,decls:46,vars:23,consts:[[1,"admin-layout"],[1,"dashboard"],[1,"date-filter","mb-3"],["type","date",1,"form-control",3,"ngModelChange","ngModel"],[1,"row","text-center","mt-3"],[1,"col-md-3"],[1,"card","shadow-sm","p-3"],[1,"text-success"],[1,"text-danger"],[3,"ngClass"],[1,"orders","mt-4"],[1,"text-primary"],[4,"ngIf"],["class","table-scroll",4,"ngIf"],[1,"table-scroll"],[1,"table","table-bordered","table-striped"],[1,"table-dark"],[4,"ngFor","ngForOf"],[1,"btn","btn-sm","btn-primary",3,"click"],["class","table-light",4,"ngIf"],[1,"table-light"],["colspan","6"],[1,"table","table-sm"]],template:function(i,r){if(i&1&&(t(0,"div",0)(1,"div",1)(2,"h2"),n(3,"\u{1F4CA} Sales Dashboard"),e(),t(4,"div",2)(5,"label"),n(6,"Select Date:"),e(),t(7,"input",3),F("ngModelChange",function(f){return T(r.selectedDate,f)||(r.selectedDate=f),f}),v("ngModelChange",function(){return r.loadOrdersByDate()}),e()(),t(8,"div",4)(9,"div",5)(10,"div",6)(11,"h5"),n(12,"Revenue"),e(),t(13,"h3",7),n(14),e()()(),t(15,"div",5)(16,"div",6)(17,"h5"),n(18,"Expenses"),e(),t(19,"h3",8),n(20),e()()(),t(21,"div",5)(22,"div",6)(23,"h5"),n(24,"Profit"),e(),t(25,"h3",9),n(26),e()()(),t(27,"div",5)(28,"div",6)(29,"h5"),n(30,"Loss"),e(),t(31,"h3",9),n(32),e()()()(),t(33,"div",10)(34,"h3"),n(35," Orders for: "),t(36,"span",11),n(37),p(38,"date"),p(39,"date"),e(),n(40),p(41,"async"),e(),g(42,G,2,0,"h1",12),p(43,"async"),g(44,Y,19,3,"div",13),p(45,"async"),e()()()),i&2){let s,f,y;a(7),B("ngModel",r.selectedDate),a(7),d("\u20B9 ",r.revenue),a(6),d("\u20B9 ",r.expense),a(5),m("ngClass",r.profit>=0?"text-primary":"text-warning"),a(),d(" \u20B9 ",r.profit," "),a(5),m("ngClass",r.loss>=0?"text-primary":"text-warning"),a(),d(" \u20B9 ",r.loss," "),a(5),d(" ",r.selectedDate?_(38,11,r.selectedDate,"dd MMM yyyy"):_(39,14,r.today,"dd MMM yyyy")," "),a(3),d(" (",((s=h(41,17,r.filteredOrders$))==null?null:s.length)||0,") "),a(2),m("ngIf",((f=h(43,19,r.filteredOrders$))==null?null:f.length)===0),a(2),m("ngIf",(((y=h(45,21,r.filteredOrders$))==null?null:y.length)??0)>0)}},dependencies:[V,N,A,R,W,z,j,L,k,$],styles:[".dashboard[_ngcontent-%COMP%]{padding:1rem;font-family:Arial,sans-serif}.date-filter[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.stats-card[_ngcontent-%COMP%]{background-color:#f5f5f5;padding:1rem;margin-bottom:1rem;border-radius:6px}.amount[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;margin-top:.5rem}.orders[_ngcontent-%COMP%]{width:100%}.table-scroll[_ngcontent-%COMP%]{overflow-x:auto;-webkit-overflow-scrolling:touch}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;min-width:600px}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:.5rem;text-align:left}.table-dark[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#343a40;color:#fff}.table-light[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#f8f9fa}@media screen and (max-width:768px){.date-filter[_ngcontent-%COMP%]{flex-direction:column}.stats-card[_ngcontent-%COMP%]{font-size:.9rem}table[_ngcontent-%COMP%]{font-size:.85rem;min-width:500px}.btn[_ngcontent-%COMP%]{padding:.25rem .5rem;font-size:.75rem}}"]})};var ce=[{path:"",component:x}];export{ce as ORDERS_ROUTES};
